---
title: "Saco_Final"
output: html_document
date: "2024-09-28"
---

```{r import csv, include=FALSE}
time_series <- read.csv("time_series_final.csv")
time_series
time_series <- na.omit(time_series)
time_series
```

```{r make a datafram, include=FALSE}
time_series_df <- as.data.frame(time_series)
tow <- as.factor(time_series_df$Tow)
```

```{r load packages, include=FALSE}
library(ggplot2)
library(dplyr)
```

```{r take out Ram, include=FALSE}
# Use filter to extract specific locations
ram_time_series <- time_series_df %>%
  filter(Site %in% c("Ram"))
ram_time_series_df <- as.data.frame(ram_time_series)
print(ram_time_series_df)
tow <- as.factor(ram_time_series_df$Tow)

```

```{r ram biovolume plot, include=FALSE}
# Create the plot
biovolume_plot <- ggplot(data = ram_time_series_df, aes(x = Date, y = BioVol, fill = tow)) + 
  geom_bar(stat = "identity", position = "dodge") +  # Use dodge for side-by-side bars
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Rotate x-axis labels for readability
  ylab("BioVolume (mL)") + 
  xlab("Date") +  # Rename axis titles
  labs(title = "Biovolume over Date") +  # Add a title
  scale_fill_manual(values = c("200" = "black", 
                                "700" = "grey"))  # Define custom colors
print(biovolume_plot)  # Show the plot
```

```{r top copepods at ram, include=FALSE}
# Summarize the data by Species and Count
summary_count_ram <- ram_time_series %>%
  group_by(Species, Tow) %>%
  summarize(total_count = sum(Count), .groups = 'drop') %>%
  arrange(desc(total_count))  # Sort in descending order

# Print the summarized result
print(summary_count_ram)
```


```{r top copepods at ram realtive abundance, include=FALSE}
relative_abundance_ram_meso <- read.csv("relative_abundance_ram_meso.csv")
relative_abundance_ram_meso_df <- as.data.frame(relative_abundance_ram_meso)
```

```{r top copepods at ram stacked bar graph 200, include=FALSE}
tow <- as.factor(relative_abundance_ram_meso_df$Tow)
stacked_bar_plot_ram <- ggplot(relative_abundance_ram_meso_df, aes(x = tow, y = Relative_Abundance, fill = Species)) +
  geom_bar(stat = "identity") +
  labs(title = "Stacked Bar Graph", x = "Tow (microns)", y = "Relative Abundance") +
  scale_fill_manual(values = c("Centropages_sp" = "red", "Acartia_sp" = "blue", "Calanus_sp" = "green", "Evadne_nordmanni" = "yellow", "Paracalanus_sp" = "orange", "Temora_longicornis" = "purple", "Oithona_sp" = "black", "Podon_polyphemoides" = "grey", "Pseudocalanus_sp" = "brown", "Copepod_nauplii" = "pink")) +  # Custom colors
  theme_minimal()

print(stacked_bar_plot_ram)
```