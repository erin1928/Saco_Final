---
title: "Saco_Final"
output: html_document
date: "2024-09-28"
---

```{r import csv, include=FALSE}
time_series <- read.csv("time_series_final.csv")
time_series
time_series <- na.omit(time_series)
time_series
```

```{r make a datafram, include=FALSE}
time_series_df <- as.data.frame(time_series)
tow <- as.factor(time_series_df$Tow)
```

```{r load packages, include=FALSE}
library(ggplot2)
library(dplyr)
```

```{r take out Ram, include=FALSE}
# Use filter to extract specific locations
ram_time_series <- time_series_df %>%
  filter(Site %in% c("Ram"))
ram_time_series_df <- as.data.frame(ram_time_series)
print(ram_time_series_df)
tow <- as.factor(ram_time_series_df$Tow)

```

```{r ram biovolume plot, include=FALSE}
# Create the plot
biovolume_plot <- ggplot(data = ram_time_series_df, aes(x = Date, y = BioVol, fill = tow)) + 
  geom_bar(stat = "identity", position = "dodge") +  # Use dodge for side-by-side bars
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Rotate x-axis labels for readability
  ylab("BioVolume (mL)") + 
  xlab("Date") +  # Rename axis titles
  labs(title = "Biovolume over Date") +  # Add a title
  scale_fill_manual(values = c("200" = "black", 
                                "700" = "grey"))  # Define custom colors
print(biovolume_plot)  # Show the plot
```

```{r top copepods at ram, include=FALSE}
# Summarize the data by Species and Count
summary_count_ram <- ram_time_series %>%
  group_by(Species, Tow) %>%
  summarize(total_count = sum(Count), .groups = 'drop') %>%
  arrange(desc(total_count))  # Sort in descending order

# Print the summarized result
print(summary_count_ram)
```


```{r top copepods at ram realtive abundance meso, include=FALSE}
meso <- read.csv("relative_abundance_ram_meso.csv")
relative_abundance_ram_meso_df <- as.data.frame(relative_abundance_ram_meso)
```

```{r top copepods at ram stacked bar graph 200, include=FALSE}
tow <- as.factor(relative_abundance_ram_meso_df$Tow)
stacked_bar_plot_ram_200 <- ggplot(relative_abundance_ram_meso_df, aes(x = tow, y = Relative_Abundance, fill = Species)) +
  geom_bar(stat = "identity") +
  labs(title = "Stacked Bar Graph", x = "Tow (microns)", y = "Relative Abundance") +
  scale_fill_manual(values = c("Centropages_sp" = "#00FFFF", "Acartia_sp" = "#89CFF0", "Calanus_sp" = "#0000FF", "Evadne_nordmanni" = "#191970", "Paracalanus_sp" = "#0096FF", "Temora_longicornis" = "#00A36C", "Oithona_sp" = "#7393B3", "Podon_polyphemoides" = "#5D3FD3", "Pseudocalanus_sp" = "#4682B4", "Copepod_nauplii" = "#CCCCFF")) +  # Custom colors
  theme_minimal()

print(stacked_bar_plot_ram_200)
```

```{r top copepods at ram realtive abundance macro, include=FALSE}
relative_abundance_ram_macro <- read.csv("relative_abundance_ram_macro.csv")
relative_abundance_ram_macro_df <- as.data.frame(relative_abundance_ram_macro)
```

```{r top copepods at ram stacked bar graph 700, include=FALSE}
tow <- as.factor(relative_abundance_ram_macro_df$Tow)
stacked_bar_plot_ram_700 <- ggplot(relative_abundance_ram_macro_df, aes(x = tow, y = Relative_Abundance, fill = Species)) +
  geom_bar(stat = "identity") +
  labs(title = "Stacked Bar Graph", x = "Tow (microns)", y = "Relative Abundance") +
  scale_fill_manual(values = c("Centropages_sp" = "#00FFFF", "Acartia_sp" = "#89CFF0", "Calanus_sp" = "#0000FF", "Evadne_nordmanni" = "#191970", "Paracalanus_sp" = "#0096FF", "Obelia_sp" = "#AAFF00", "Carcinus_maenas" = "#AFE1AF", "Podon_polyphemoides" = "#5D3FD3", "Pseudocalanus_sp" = "#4682B4", "Gammarus_sp" = "#454B1B")) +  # Custom colors
  theme_minimal()

print(stacked_bar_plot_ram_700)
```

```{r top copepods at ram realtive abundance all, include=FALSE}
ram_relative_abundance <- read.csv("ram_relative_abundance.csv")
ram_relative_abundance_df <- as.data.frame(ram_relative_abundance)
```

```{r top copepods at ram stacked bar graph both, include=FALSE}
tow <- as.factor(ram_relative_abundance_df$Tow)
stacked_bar_plot_ram <- ggplot(ram_relative_abundance_df, aes(x = tow, y = Relative_Abundance, fill = Species)) +
  geom_bar(stat = "identity") +
  labs(title = "Ram Island Most Common Copepods", x = "Tow (microns)", y = "Relative Abundance") +
  scale_fill_manual(values = c("Centropages_sp" = "#00FFFF", "Acartia_sp" = "#89CFF0", "Calanus_sp" = "#0000FF", "Evadne_nordmanni" = "#191970", "Paracalanus_sp" = "#0096FF", "Obelia_sp" = "#AAFF00", "Carcinus_maenas" = "#AFE1AF", "Podon_polyphemoides" = "#5D3FD3", "Pseudocalanus_sp" = "#4682B4", "Gammarus_sp" = "#454B1B", "Oithona_sp" = "#7393B3", "Temora_longicornis" = "#00A36C", "Copepod_nauplii" = "#CCCCFF")) +  # Custom colors
  theme_minimal()

print(stacked_bar_plot_ram)
```

```{r top copepods at ram and date, include=FALSE}
# Summarize the data by Species and Count
summary_date_count_ram <- ram_time_series %>%
  group_by(Species, Tow, Date) %>%
  summarize(total_count = sum(Count), .groups = 'drop') %>%
  arrange(desc(total_count))  # Sort in descending order

# Print the summarized result
print(summary_date_count_ram)
```

```{r top copepods at ram count and date line graph, include=FALSE}

ram_sorted_date_count <- summary_date_count_ram %>%
  filter(Species %in% c("Acartia_sp", "Calanus_sp", "Evadne_nordmanni", "Paracalanus_sp", "Obelia_sp", "Carcinus_maenas", "Podon_polyphemoides", "Pseudocalanus_sp", "Gammarus_sp", "Oithona_sp", "Temora_longicornis", "Copepod_nauplii"))

date_count_ram_df <- as.data.frame(ram_sorted_date_count)

# Create the line graph
line_graph <- ggplot(data = date_count_ram_df, aes(x = Date, y = total_count, color = Species, group = Species)) +
  geom_line() +  # Add lines
  geom_point() + # Optionally add points at data points
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Rotate x-axis labels for readability
  ylab("Count") + xlab("Date") +  # Rename axis titles
  scale_color_manual(values = c(
    "Acartia_sp" = "#89CFF0", "Calanus_sp" = "#0000FF", "Evadne_nordmanni" = "#191970", "Paracalanus_sp" = "#0096FF", "Obelia_sp" = "#AAFF00", "Carcinus_maenas" = "#AFE1AF", "Podon_polyphemoides" = "#5D3FD3", "Pseudocalanus_sp" = "#4682B4", "Gammarus_sp" = "#454B1B", "Oithona_sp" = "#7393B3", "Temora_longicornis" = "#00A36C", "Copepod_nauplii" = "#CCCCFF"
  )) +  # Define colors for each species
  labs(title = "Count of Species Over Salinity")  # Add a title if desired

print(line_graph)  # Show the plot
```

